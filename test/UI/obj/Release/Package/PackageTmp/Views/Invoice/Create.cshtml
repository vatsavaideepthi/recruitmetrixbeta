@model UI.Models.CreateInvoice
@{
    Layout = "~/Views/Shared/_loggedin.cshtml";
    ViewBag.Title = "Create Invoice";
}

@section Scripts{
    @* <script src="~/Scripts/tracker/invoice.js"></script>*@
    <script src="~/Scripts/tracker/generateinvoice.js"></script>
    <script src="~/Scripts/tracker/customer.js"></script>
    <script src="~/Scripts/tracker/data.js"></script>
    <script src="~/Scripts/tracker/utilities.js"></script>
    <script>
        $(function () {
            $("#tags").autocomplete({
                source: function (request, response) {
                    $.ajax({
                        url: "/AjaxData/GetJsonCustomerlist",
                        type: "POST",
                        dataType: "JSON",
                        data: {
                            tag: ''
                        },
                        success: function (data) {
                            if (data.length > 0) {
                                var result = $.parseJSON((JSON.stringify(data)));
                                response($.map(result, function (k, v) {
                                    return {
                                        label: k.name,
                                        value: k.id
                                    }
                                }))
                            }
                            else {
                                $('#tags').hide();
                                $('#mancrcustblock').show();
                            }
                        },
                        error: function (data) {
                        }
                    })
                },
                select: function (event, ui) {
                    try {
                        $('#currentcustomer').val(ui.item.value);
                        $('#tags').val(ui.item.label);
                        $('#chscustomerselected').removeClass('hide');
                        
                    }
                    catch (e) { }
                    return false;
                },
                open: function () {
                    $('.ui-autocomplete li').last().after('<li id="crncust" class="ui-menu-item" role="presentation"><a  class="ui-corner-all" tabindex="-1">Create New Customer</a></li>');
                    return {
                        label: 'dummy',
                        value: '00000000000000000000000000000000'
                    }
                },
                focus: function () {

                }

            });



        });

        $('.rowtotal,.discount,.shipping,.totalamount,.rowunitprice,.rowquantity,.rowtax').numeric();
    </script>
}


@section actionset{
    <div class="container-fluid">
        <ul class="nav pull-right">
            <li class="save-inv"><a href="#">Save</a></li>
            <li class="edit-inv"><a id="actionsetchangecustomer" href="#">Change Customer</a></li>
        </ul>
    </div>
}



<div>

    @using (Html.BeginForm("GenerateInvoice", "Invoice", FormMethod.Post, new { id = "generateinvoiceform" }))
    {
        @Html.Raw(Model.templatedata);
    }
</div>

<div id="ruleholder">
    <input id="viewid" type="hidden" value="invoice-create" />
    <input id="currenttemplate" type="hidden" value="@Model.templateid"/>
    <input id="currentcustomer" type="hidden" value="@Model.customerid"/>
    <input id="currentcompanyid" type="hidden" value="@Model.companyid" />
</div>

<div id="choosecustomermodal" class="modal hide fade">
    <div class="modal-header">
        <h3 id="modaltitle">Choose Customer</h3>
    </div>
    <div class="modal-body">
        <div id="chscutomer">
            <div>
                <input type="text" placeholder="Select Customer" id="tags" />
                <button id="chscustomerselected" type="button" class="btn btn-info pull-right hide" value="Done">Done</button>
            </div>
            <div id="mancrcustblock" style="display: none;">
                <span>No Customers Available...</span>
                <input type="button" value="Create Customer" id="mancrsutomer" class="btn btn-info" />
            </div>
        </div>
    </div>
</div>

<div id="createCustomermodal" class="modal hide fade" data-backdrop="static">
    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        <h3 id="modaltitle1">Add New Customer</h3>
    </div>
    <div class="modal-body">
        <div id="crncustomer">
            <div>
                <div>
                    <input type="text" value="" id="newcustname" placeholder="Enter Customer Name" />
                    <input type="text" value="" id="newcustemail" placeholder="Enter customer Email" />
                </div>
                <div>
                    <input id="next1" type="button" value="Create New Customer" class="btn btn-info" />
                </div>
            </div>
        </div>
        <div id="crncustomeraddress" class="hide">
            <div>
                <input type="hidden" id="customerid" />
                <input type="hidden" id="customeremail" />
                <div>
                    <input type="text" value="" id="addline1" placeholder="Address Line 1" />
                    <input type="text" value="" id="addline2" placeholder="Address Line 2" />
                    <input type="text" value="" id="addzipcode" placeholder="Pincode" />
                </div>
                <div>
                    <input id="next2" type="button" value="Add Address" class="btn btn-info" />
                </div>
            </div>
        </div>
        <div id="crncustomercontact" class="hide">
            <div>
                <div>
                    <input type="text" value="" id="addtitle" placeholder="Title" />
                    <input type="text" value="" id="addfname" placeholder="First name" />
                    <input type="text" value="" id="addlname" placeholder="Last Name" />
                    <input type="text" value="" id="addemail" placeholder="Email" />
                    <input type="text" value="" id="addmob" placeholder="Mobile Number" />
                </div>
                <div>
                    <input id="next3" type="button" value="Add Contact" class="btn btn-info" />
                </div>
            </div>
        </div>

        <div id="crncustomerfinish" class="hide">
            <div>
                <div>
                    <label>Customer Created Successfully</label>
                </div>
                <div>
                    <input id="next4" type="button" value="Done" class="btn btn-info" />
                </div>
            </div>

        </div>
    </div>
</div>

<div id="addressmodal" class="modal hide fade">
    <div class="modal-header">
        <h3 id="modaltitle2">Add New Customer</h3>
    </div>
    <div class="modal-body">
        <div id="updaddresstocustomer">
            <div>
                <input type="hidden" id="updcustomerid" />
                <input type="hidden" id="updcustomeremail" />
                <div>
                    <input type="text" value="" id="updaddline1" placeholder="Address Line 1" />
                    <input type="text" value="" id="updaddline2" placeholder="Address Line 2" />
                    <input type="text" value="" id="updaddzipcode" placeholder="Pincode" />
                </div>
                <div>
                    <input id="updaddress" type="button" value="Add Address" class="btn btn-info" />
                </div>
            </div>
        </div>
    </div>
</div>

<div id="contactmodal" class="modal hide fade">
    <div class="modal-header">
        @*  <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>*@
        <h3 id="modaltitle3">Add Customer Contact</h3>
    </div>
    <div class="modal-body">
        <div id="updcontacttocustomer" class="hide">
            <div>
                <div>
                    <input type="text" value="" id="updtitle" placeholder="Title" />
                    <input type="text" value="" id="updfname" placeholder="First Name" />
                    <input type="text" value="" id="updlname" placeholder="Last Name" />
                    <input type="text" value="" id="updcontemail" placeholder="Email" />
                    <input type="text" value="" id="updcontmob" placeholder="Mobile Number" />

                    <input type="checkbox" value="Apply This " />
                </div>
                <div>
                    <input id="updcontact" type="button" value="Add Contact" class="btn btn-info" />
                </div>
            </div>
        </div>
    </div>
</div>
<div id="choosetemplatemodal" class="modal hide fade">
    <div id="chstemplate" class="hide">
        <h5>Choose template</h5>
        <div>
            <ul class="nav nav-pills">
                <li>
                    <div>
                        <input type="radio" name="templatechoice" value="Default Template" checked="true" />
                        Default Template
                    </div>
                </li>
                <li style="padding: 0px 10px;">
                    <div>
                        <span>OR</span>
                    </div>
                </li>
                <li>
                    <div>
                        <input type="button" value="Select other Template" />
                    </div>
                </li>
            </ul>
        </div>
    </div>
</div>

<div id="createinvoiceresult">
    <div class="success hide">
        <div class="alert alert-success">
            Invoice Successfully Created...
            <a >Click here to View Invoice</a>
        </div>
    </div>
    <div class="failure hide">
        <div class="alert alert-success">
            Invoice Successfully Created...
        </div>
    </div>
</div>



