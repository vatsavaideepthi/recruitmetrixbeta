@model List<UI.Models.Job>
@{
    ViewBag.Title = "Jobs";
    ViewBag.highlight = "jobs";
    Layout = "~/Views/Shared/_JobPortalMasterView.cshtml";
}

<span class="pageheader">Requirements</span>


<div style="padding-bottom: 15px;" class="pull-right">

    <a href="/jobs/add" target="_self" class="btn-green btn-flat btn-wide">Add Job</a>
    <a id="popbulkemail" class=" disabled btn-green btn-flat btn-wide btn-disabled" @*href="#SendJobBulkMail"*@ role="button" data-toggle="modal">Bulk Email</a>
    <div class="btn-group">
        @*  <a class=" btn-green btn-flat btn-wide"  role="button" data-toggle="modal">Actions</a>*@
        <button class="btn-green btn-flat btn-shrink dropdown-toggle" data-toggle="dropdown">
            Actions&nbsp;&nbsp;<span class="caret"></span>
        </button>
        @*<ul class="dropdown-menu">
            <li class=" disabled action-item"><a tabindex="-1" href="#" >Deactiavate Job</a></li>
            <li class="disabled action-item"><a tabindex="-1" href="#">Assign to Employee</a></li>
        </ul>*@
    </div>
</div>
<div id="requirementjobcollection" class="divjob" style="display: block;">
    @if (Model != null && Model.Count > 0)
    {
        foreach (UI.Models.Job job in Model)
        {
            bool candname = false;
            try
            {
                var decodeddata = Json.Decode(job.jobdata);
                
                candname = decodeddata.payratenegotaible;
            }
            catch { }
        <ul>

            <li class="listRow jobrow"  data-jobid="@job.JobId" data-jobposteddate="@job.PostDate.ToString()">
                <div class="jobbox" style="padding: 5px 2px;">
                    <div style="padding: 0px 10px;" class="pull-left">
                        <input type="checkbox" class="chkjob" />
                    </div>
                    <div style="width: 30%; margin-left: 10px;" class="pull-left">
                        <div>
                            <p>@Html.ActionLink(job.JobName, "show", "jobs", new { jobid = job.JobId }, new { @class = "jobtitle", title = "View Job" })
                                <a href="jobs/edit?jobid=@job.JobId" target="_self" class=" icon icon-edit " title="Edit Job"> </a>
                                  <a href="jobs/jobspage?jobid=@job.JobId" target="_self" class=" icon icon-edit hide " title="new"> </a>
                                    
                                    
                            </p>
                            <span class="experience">@job.Exp</span> Years Experience in <span class="gridLabelValues location">@job.State</span>
                        </div>
                        <div style="margin-top: 3px; word-break: break-all">
                            <span class="jobskills">@job.PrefSkills</span>
                        </div>
                    </div>


                   
                    <div style="display: inline-block; float: right; padding: 5px;">
                                                    @if (job.jobmailstatus == "1")
                            
                        {
                            <div>
                                <img src="~/Content/images/email-send-icon.png" style="width: 20px; height: 21px;" title="Bulk Mail Sent" />
                            </div>
                        }
                        <div>
                            <a style="cursor: pointer;" class="getjobnotes" data-jobid="@job.JobId"><i class="icon  icon-th-list" title="Notes"></i></a>
                        </div>
                        <div>
                           <i class="delete-job icon icon-trash" title="Delete job" data-jobid="@job.JobId" data-title="@job.JobName"  style="cursor:pointer;"></i>
                        </div>
                      

                    </div>



                    <div style="width: 30%;" class="pull-left">
                        <table class="normal-table jobtable">
                            <tr>
                                <td>Expires On</td>
                                <td>&nbsp;<span> : </span>&nbsp; </td>
                                <td><span class="expiry" data-jobid="@job.JobId">@job.ExpiryDate.ToShortDateString()</span>
                                </td>
                            </tr>
                            <tr>
                                <td>Pay Rate</td>
                                <td>&nbsp;<span> : </span>&nbsp;</td>
                                <td><span >$ <span class="payrate" data-payrate="@job.PayRate" data-payratemax="@job.payratemax">@job.PayRate-@job.payratemax</span> /Hr 
                                    @if (candname)
                                    {
                                        <i class="icon icon-star" title="Pay Rate Negotiable"></i>
                                    }
                                </span></td>
                            </tr>
                            <tr>
                                <td>Job Type</td>
                                <td>&nbsp;<span> : </span>&nbsp;</td>
                                <td><span class="jobtype">@job.postype</span></td>
                            </tr>
                            <tr>
                                <td>Job Length</td>
                                <td>&nbsp;<span> : </span>&nbsp;</td>
                                <td><span class="additionaldetails">@job.additionaldetails</span></td>
                            </tr>
                        </table>
                    </div>
                    <div style="width: 30%;" class="pull-left">
                        <table class="normal-table jobtable">
                            <tr>
                                <td>Posted On</td>
                                <td>&nbsp;<span> : </span>&nbsp;</td>
                                <td>@job.StartDate.ToShortDateString()</td>
                            </tr>
                            <tr>
                                <td>Assigned To</td>
                                <td>&nbsp;<span> : </span>&nbsp;</td>
                                <td><span class="">Assigned to No One</span></td>
                            </tr>
                            <tr>
                                <td>Status</td>
                                <td>&nbsp;<span> : </span>&nbsp;</td>
                                <td><span>@job.Status<i class="icon icon-edit updjobstatus" title="Edit Job Status" data-jobid="@job.JobId" style="margin-left:5px;"></i></span></td>
                            </tr>
                            <tr>
                                <td>Applicants</td>
                                <td>&nbsp;<span> : </span>&nbsp; </td>
                                <td>@(job.applications.Count > 0 ? job.applications.Count + " Applicants" : "No Applicants Available")</td>
                            </tr>

                        </table>

                    </div>
                    </div>
                   @* <div style="padding: 0px 15px;" class="pull-right">
                        <table class="normal-table jobtable">
                            <tr>
                                <td><a style="cursor: pointer;" class="getjobnotes" data-jobid="@job.JobId">Notes </a>&nbsp;</td>
                            </tr>
                        </table>
                    </div>*@
            </li>
        </ul>
                                                 
                                            
        }
    }
    else
    {<ul style="padding-top: 40px;">
        <li style="list-style: none;">
            <div class="well">
                <div class="pull-left" style="margin: 5px 0px 10px 0px; font-size: 25px; font-weight: bold;">
                    <span>No Requirements posted Yet...</span>
                </div>

            </div>
        </li>
    </ul>
    }
</div>

<div class="row-fluid">
    
    <div id="SendJobBulkMail" class="modal hide fade " style="width: 80%; border-radius: 0px; left: auto;">

        @Html.Partial("~/Views/common/Messaging/_BulkEmailJobsToCandidates.cshtml", new UI.Models.MessagingObjectModel.JObsBulkMail())

    </div>
</div>

<div id="UpdateJobStatus" class="modal hide fade" style="min-width: 650px !important;">
    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        <h3>Update Job Status</h3>
    </div>
    <div class="modal-body">
        <form>
            <input type="hidden" id="chosenqjobid" />
            <input type="reset" id="resetupdjobstatusform" style="display: none;" />
            <div>
                @* <span class="jobtitle">Questionaire</span>*@
            </div>
            <div style="margin: auto;">
                <table class="table jobtable questionairetable">
                    <tbody>

                        <tr>
                            <td><span style="float: right;">Job Status</span></td>
                            <td>:</td>
                            <td>
                                <div>
                                    <select id="modal-upd-jobstatus" class="modal-upd-wrkauth input-wide input-well" style="width: 281px !important; height: 40px;">
                                        <option>Active</option>
                                        <option>Inactive</option>
                                        <option>On Hold</option>
                                        <option>Filled</option>
                                        <option>Expired</option>
                                        <option>Closed</option>
                                        <option>Hot</option>
                                    </select>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </form>
    </div>
    <div class="modal-footer" style="">
        <a id="updatecurrentjobstatus" class="btn-green btn-flat pull-right" style="margin-left: 10px;">Update</a>
        @* <a class="btn-flat btn-grey close " data-dismiss="modal" aria-hidden="true" style="margin-left: 10px; opacity: 1;">Cancel</a>*@
    </div>
</div>

<div id="jobnotescontainer" class="modal hide fade" style="min-width: 650px !important;">
    <div class="modal-header">
        <div id="notesactionscontainer" style="display: inline-block; float: right;">
            <div class="top-action-set">
                <span style="cursor: pointer;" id="btnaddnewnotesjob" class="btn-flat btn-green pull-right">Add New</span>
            </div>
        </div>

        <h3 id="jobnotesmodelheader">Notes</h3>
    </div>
    <div class="modal-body">
        <form>
            <input type="hidden" id="currentjobid" />
            <input type="hidden" id="notesdata">
            <input type="hidden" id="notesapplicationid">
            <input type="reset" id="resetnotesjobform" style="display: none;" />
            <input type="hidden" id="currentmodifyingnotesid" />
            <input type="hidden" id="currentownerid" />
            <div>
                <div id="jobnoteslistholder" class="hide">
                    <ul class="jobnotes">
                    </ul>
                </div>
                <div id="emptyjobnotesholder" class="hide">
                    <span>No Notes Available for this Entry</span>
                </div>

                <div id="jobnewnotesholder" class="hide">
                    <div>
                        <textarea id="jobnewnotescontent" style="width: 98%; resize-horizontal: none; max-width: 98%;" placeholder="Add something to notes"></textarea>
                    </div>
                </div>
            </div>
        </form>
    </div>
    <div class="modal-footer">
        <div id="jobnotesactioncontainer" class="hide">
            <a id="jobcancelnotes" class="btn-flat btn-grey -right" style="margin-left: 10px;">Cancel </a>
            <a id="jobsavenewnotes" class="btn-flat btn-green pull-right" style="margin-left: 10px;">Save</a>
        </div>
        <div id="updjobnotes" class="hide">
            <a id="cancelnotesupdate" class="btn-flat btn-grey pull-right" style="margin-left: 10px;">Cancel </a>
            <a id="updatebuttonjobnotes" class="btn-green btn-flat pull-right" data-noteid="" style="margin-left: 10px;">Update</a>
        </div>
        <div id="back">
            <span class="btn-wide pull-right btn-flat btn-grey" data-dismiss="modal" aria-hidden="true">Done</span>
        </div>
    </div>
</div>

<div id="deletejob" class="modal hide fade" style="min-width: 650px !important;">
    <div class="modal-header">
         <h3>Delete Job</h3>
    </div>
    <div class="modal-body">
        <form>
            <input type="hidden" id="chosenjobid" />
           <div>
                @* <span class="jobtitle">Questionaire</span>*@
            </div>
            <div style="margin: auto;">
                <table class="table jobtable questionairetable">
                    <tbody>

                        <tr>
                            <td><span style="float: left;">Are you sure to delete this <span id="jobtitle" ></span> job?</span></td>
                          
                            <td>
                               
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </form>
    </div>
    <div class="modal-footer" style="">
        <a id="deletejobno" class="btn-green btn-flat pull-right" style="margin-left: 10px;">No</a>
        <a id="deletejobyes" class="btn-green btn-flat pull-right" style="margin-left: 10px;">Yes</a>
      
    </div>
</div>

@*<script type="text/javascript">

    $(document).ready(function () {
     
        $("#editexpiry").datepicker({
            minDate: new Date(),
            onSelect: function (dateText, inst) {
                var date = $(this).val();
                $(".expiry").val($(this).val());
                $('#editexpiry').removeClass('alertred');
            }
        });

        //Code block to show the Jquery UI Datetime picker for expirydate in Add Job Form when it's trgger button clicked

        $('#jobexpirydatetrigger').click(function () {
            $("#editexpiry").datepicker("show");
        });
<<<<<<< .mine
        $('#updatejobinformation').click(function () {
           // var jobdata = jQuery.parseJSON($('#currentjobdata').val());
       
            //jobdata.payrate = $(".editpayrate").val()
        
            $.ajax({
                url: "/Jobs/UpdateJob",
                type: "POST",
                dataType: "JSON",
                data: {
                    jobid: $('#currentqjobid').val(),
                    jobname: $('.edittitle').val(),
                    payrate:$('.editpayrate').val(),
                    preferenceskills: $('.editskills').val(),
                    positiontype: $('.editexperience').val(),
                    cityid: $('.editlocation').val(),
                    categoryid:'',
                    subcategoryid:'',
                    jobdescription:'',
                    preferenceskills:'',
                    startdate:'',
                    startmonth:'', 
                    startyear:'',
                    enddate:'',
                    endmonth:'',
                    endyear:'',
                    expid:0,
                    publish:0,
                    objectid:'',
                    objecttype:'', 
                    email:'',
                    phone: '',
                    partnerslist: '',
                    data: '',
                    additionaldetails: ''
=======

>>>>>>> .theirs    //    $('.editjob').click(function () {
    //        $('#currentqjobid').val($(this).attr('data-jobid'));
    //        $('#currentmodifydate').val($(this).attr('data-modifieddate'));
    //        $('#currentjobdata').val($(this).attr('data-jobdata'));
    //        $('#currentexpid').val($(this).attr('data-expid'));
    //        $('#currentpublish').val($(this).attr('data-publish'));
    //        $('#currentemail').val($(this).attr('data-email'));
    //        $('#currentphone').val($(this).attr('data-phone'));
    //        $('#currentjobdesc').val($(this).attr('data-desc'));
    //        var jobblock = $(this).parents('.jobrow').clone();
    //        var jobtitle = $(jobblock).find('.jobtitle');
    //        var joblocation = $(jobblock).find('.location');
    //        var jobexperience = $(jobblock).find('.experience');
    //        var jobskills = $(jobblock).find('.jobskills');
    //        var jobexpirydate = $(jobblock).find('.expiry');
    //        var jobpayrate = $(jobblock).find('.payrate');
    //        var jobtype = $(jobblock).find('.jobtype');
    //        var jobdetails = $(jobblock).find('.additionaldetails');
    //        $('.edittitle').val($(jobtitle).text());
    //        $('.editjobtype').val($(jobtype).text());
    //        $('.editexperience').val($(jobexperience).text());
    //        $('.editlocation').val($(joblocation).text());
    //        $('.editskills').val($(jobskills).text());
    //        $('#editexpiry').val($(jobexpirydate).text());
    //        $('.editpayrate').val($(jobpayrate).text());
                  
    //        $('#updatejob').modal('show');
    //    });
    //    $('#updatejobinformation').click(function () {
    //        var jobdata = jQuery.parseJSON($('#currentjobdata').val());
    //       // $('#currentmodifydate').val();
    //        var newdate = new Date();
    //        var mmonth = newdate.getMonth() + 1;
    //        var mday = newdate.getDate();
    //        var myear = newdate.getFullYear();
    //        var modexp = $('.editexperience').val();
    //        modexp = modexp.replace("to", "");
    //        jobdata.payrate = $(".editpayrate").val()
    //        var day1 = $("#editexpiry").datepicker('getDate').getDate();
    //        var month1 = $("#editexpiry").datepicker('getDate').getMonth() +1;
    //        var year1 = $("#editexpiry").datepicker('getDate').getFullYear();
    //        $.ajax({
    //            url: "/Jobs/UpdateJob",
    //            type: "POST",
    //            dataType: "JSON",
    //            data: {
                  
    //                jobid  : $('#currentqjobid').val(),
    //                categoryid: '',
    //                subcategoryid: '',
    //                jobname: $('.edittitle').val(),
    //                jobdescription: $('#currentjobdesc').val(),
                   
    //                payrate:$('.editpayrate').val(),
    //                preferenceskills: $('.editskills').val(),
    //                positiontype: modexp,
    //                cityid: $('.editlocation').val(),
    //                startdate: mday,
    //                startmonth:mmonth,
    //                startyear: myear,   
    //                enddate: day1,
    //                endmonth: month1,
    //                endyear: year1,
    //                expid: $('#currentexpid').val(),
    //                publish: $('#currentpublish').val(),
    //                objecttype: 'jobpost',         
    //                email: $('#currentemail').val(),
    //                phone: $('#currentphone').val(),           
    //                partnerslist: '',
    //                data: JSON.stringify(jobdata),
    //                additionaldetails: ''
    //            },
    //            async: false,
    //            success: function (data) {
    //                $('#updatejob').modal('hide');
    //            },
    //            error: function (data) {
    //            }

    //        });
    //        $('#updatejob').modal('hide');
    //        location.reload();

    //    });

    //});
</script>*@



@section Scripts{
    <script src="~/Scripts/jobportal/PortalJobs.js"></script>
    <script src="~/Scripts/jobportal/portalcandidates.js"></script>
    <script src="~/Plugins/JqueryTE/jquery-te-1.4.0.min.js"></script>
}
